<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Generate REST samples for Azure Cognitive Services</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles/bootstrap-social.css">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="alert alert-danger" role="alert" align="center">
      <strong>This generator is still in Beta. All code samples require thorough review and testing before being published. <br />Found a bug? <a href="https://github.com/erhopf/REST-templates/issues/new">Create an issue</a>.</strong>
    </div>
  <div class="container">
    <div id="app">
      <div class="row">
      <div class="col-md-5" id="formInputs">
      <h2>Inputs</h2>
      <p>Name your function: <br/>
      <input v-model="functionName" placeholder="e.g. testCall" class="form-control"></p>
      <p>Enter the base URL: <br/>
      <input v-model="baseURL" placeholder="e.g. https://azure.microsoft.com/" class="form-control"></p>
      <p>Enter the resource/endpoint: <br/>
      <input v-model="resource" placeholder="e.g. translate-text" class="form-control"></p>
      <p>Select authorization type: <br/>
        <input type="radio" id="subscriptionKey" value="subscriptionKey" v-model="authHeaders" class="form-check-input">
        <label for="subscriptionKey">Ocp-Apim-Subscription-Key</label><br />
        <input type="radio" id="accessToken" value="accessToken" v-model="authHeaders" class="form-check-input" >
        <label for="accessToken">Authorization: Bearer</label></p>
      <p>Select content type: <br />
        <select v-model="contentTypeHeader">
        <option disabled value="">Please select one</option>
        <option>application/json</option>
        <option>multipart/form-data</option>
        <option>audio/wav</option>
        </select>
      <p>Select optional headers: <br />
        <input type="checkbox" id="xTraceIdHeader" value="xClientTraceId" v-model="optionalHeaders" class="form-check-input" >
        <label for="xTraceIdHeader">X-ClientTraceId</label></p>
      <p>Select HTTP request method: <br/>
         <input type="radio" id="GET" value="get" v-model="httpMethod" class="form-check-input" >
         <label for="GET">GET &nbsp;</label>
         <input type="radio" id="POST" value="post" v-model="httpMethod" class="form-check-input" >
         <label for="two">POST &nbsp;</label>
         <input type="radio" id="PUT" value="put" v-model="httpMethod" class="form-check-input" >
         <label for="put">PUT &nbsp;</label>
         <input type="radio" id="DELETE" value="delete" v-model="httpMethod" class="form-check-input" >
         <label for="put">DELETE &nbsp;</label></p>
      <p>Set request parameters: <br/>
        Key: <input v-model="params[0].key" placeholder="Key"> Value: <input v-model="params[0].value" placeholder="Value"><br/>
        Key: <input v-model="params[1].key" placeholder="Key"> Value: <input v-model="params[1].value" placeholder="Value"><br/>
        Key: <input v-model="params[2].key" placeholder="Key"> Value: <input v-model="params[2].value" placeholder="Value"><br/>
        Key: <input v-model="params[3].key" placeholder="Key"> Value: <input v-model="params[3].value" placeholder="Value"></p>
      <p>Request body (must be valid JSON): <br/>
        <textarea v-model="jsonBody" placeholder="Enter valid JSON for your request." class="form-control" rows="6"></textarea></p>
    </div>
    <div class="col-md-7" id="codeSamples">
      <h2>Code Samples</h2>
      <p>Code samples have been generated in the following languages based on your inputs.</p>
      <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="pill" href="#node">Node.js</a></li>
        <li><a data-toggle="pill" href="#python">Python</a></li>
        <li><a data-toggle="pill" href="#go">Go</a></li>
        <li><a data-toggle="pill" href="#java">Java</a></li>
        <li><a data-toggle="pill" href="#curl">cURL</a></li>
      </ul>
        <div class="tab-content">
          <div id="node" class="tab-pane fade in active"></br>
            <div id="git-btn-node" align="right">
            <a href="https://github.com/erhopf/REST-templates/edit/master/Node/restTemplate.js" target="_blank" class="btn btn-social btn-sm btn-github">
              <span class="fa fa-github"></span> Improve this template!
            </a></div>
            <pre>const request = require('request');<span v-if="optionalHeaders.includes('xClientTraceId')"><br/>const uuidv4 = require('uuid/v4');</span>
const subscriptionKey = process.env.YOUR_ENV_VARIABLE;
if (!subscriptionKey) {
    throw new Error('Environment variable for your subscription key is not set.')
};
function {{ functionName }}(){
    let options = {
        method: '{{ httpMethod }}',
        baseUrl: '{{ baseURL }}',
        url: '{{ resource }}',
        qs: {<template v-for='param in params' v-if='(param.key.length > 0 && param.value.length > 0)'>
            '{{ param.key }}': '{{ param.value }}',</template>
        },
        headers: {<span v-if="authHeaders.includes('subscriptionKey')"><br /><span v-html="asciiTripleTab"></span>'Ocp-Apim-Subscription-Key': subscriptionKey</span><span v-if="authHeaders.includes('accessToken')"><br /><span v-html="asciiTripleTab"></span>'Authorization': 'Bearer YOUR_TOKEN_HERE'</span><span v-if='contentTypeHeader.length > 1'>,<br /><span v-html="asciiTripleTab"></span>'Content-Type': '{{contentTypeHeader}}'</span><span v-if="optionalHeaders.includes('xClientTraceId')">,<br /><span v-html="asciiTripleTab"></span>'X-ClientTraceId': uuidv4().toString()</span>
        },
        body: {{ jsonBody }},
        json: true,
    };
    request(options, function(err, res, body){
        console.log(JSON.stringify(body, null, 4));
    });
};

{{ functionName }}();</pre>
          <a href="https://repl.it/languages" class="btn btn-success btn-lg btn-block" target="_blank">Test your code on repl.it</a>
          </div>
          <div id="python" class="tab-pane fade"></br>
            <div id="git-btn-py" align="right">
            <a href="https://github.com/erhopf/REST-templates/edit/master/Python/restTemplate.py" target="_blank" class="btn btn-social btn-sm btn-github">
              <span class="fa fa-github"></span> Improve this template!
            </a></div>
            <pre>import os, requests,<span v-if="optionalHeaders.includes('xClientTraceId')"> uuid,</span> json

if 'NAME_OF_YOUR_ENV_VARIABLE' in os.environ:
    subscriptionKey = os.environ['NAME_OF_YOUR_ENV_VARIABLE']
else:
    print('Environment variable for your subscription key is not set.')
    exit()

#If you want to set your subscription key as a string, uncomment the line below
#and delete the condition statement that starts with if and ends with exit().
#subscriptionKey = 'put_your_key_here'

base_url = '{{ baseURL }}'
path = '{{ resource }}'
params = {<template v-for='param in params' v-if='(param.key.length > 0 && param.value.length > 0)'>
    '{{ param.key }}': '{{ param.value }}',</template>
}

constructed_url = base_url + path

headers = {<span v-if="authHeaders.includes('subscriptionKey')"><br /><span v-html="asciiTab"></span>'Ocp-Apim-Subscription-Key': subscriptionKey</span><span v-if="authHeaders.includes('accessToken')"><br /><span v-html="asciiTab"></span>'Authorization': Bearer YOUR_TOKEN_HERE</span><span v-if='contentTypeHeader.length > 1'>,<br /><span v-html="asciiTab"></span>'Content-Type': '{{contentTypeHeader}}'</span><span v-if="optionalHeaders.includes('xClientTraceId')">,<br /><span v-html="asciiTab"></span>'X-ClientTraceId': str(uuid.uuid4())</span>
}

body = {{ jsonBody }}

request = requests.{{ httpMethod }}(constructed_url, <span v-if="params[0].key.length >= 1">params=params, </span>headers=headers<span v-if="jsonBody.length >= 1">, json=body</span>)
response = request.json()

print(json.dumps(response, sort_keys=True, indent=4, ensure_ascii=False, separators=(',', ': ')))</pre>
          <a href="https://repl.it/languages" class="btn btn-success btn-lg btn-block" target="_blank">Test your code on repl.it</a>
          </div>
          <div id="go" class="tab-pane fade"></br>
            <div class="alert alert-info" role="alert">The sample generator doesn't support <code>X-ClientTraceId</code> for Go at this time.</div>
            <div id="git-btn-py" align="right">
            <a href="https://github.com/erhopf/REST-templates/blob/master/GoLang/restTemplate.go" target="_blank" class="btn btn-social btn-sm btn-github">
              <span class="fa fa-github"></span> Improve this template!
            </a></div>
            <pre>package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "log"
    "net/http"
    "net/url"
    "os"
)

func main() {
    subscriptionKey := os.Getenv("YOUR_SUBSCRIPTION_KEY")
    if subscriptionKey == "" {
        log.Fatal("Environment variable YOUR_SUBSCRIPTION_KEY is not set.")
    }
    {{ functionName }}(subscriptionKey)
}

func {{ functionName }}(subscriptionKey string) {
    u, _ := url.Parse("{{ baseURL }}{{ resource }}")
    q := u.Query()<template v-for='param in params' v-if='(param.key.length > 0 && param.value.length > 0)'>
    q.Add("{{ param.key }}", "{{ param.value }}")</template>
    u.RawQuery = q.Encode()
    <span v-if='jsonBody.length >= 1'>body := []struct {
        Text string
    }{
        {{ jsonBody }}
    }
    b, _ := json.Marshal(body)</span>
    req, err := http.NewRequest("{{ httpMethod | capitalize }}", u.String(), <span v-if="jsonBody.length >= 1">bytes.NewBuffer(b)</span><span v-if="jsonBody.length < 1">nil</span>)
    if err != nil {
        log.Fatal(err)
    }
    <span v-if="authHeaders.includes('subscriptionKey')">req.Header.Add("Ocp-Apim-Subscription-Key", subscriptionKey)</span><span v-if="authHeaders.includes('accessToken')">req.Header.Add("Authorization", "Bearer YOUR_TOKEN_HERE")</span><span v-if='contentTypeHeader.length > 1'><br /><span v-html="asciiTab"></span>req.Header.Add("Content-Type", "{{ contentTypeHeader }}")</span>

    res, err := http.DefaultClient.Do(req)
    if err != nil {
        log.Fatal(err)
    }

    var result interface{}
    if err := json.NewDecoder(res.Body).Decode(&result); err != nil {
      log.Fatal(err)
    }

    prettyJSON, _ := json.MarshalIndent(result, "", "  ")
    fmt.Printf("%s\n", prettyJSON)
}</pre>
            <a href="https://repl.it/languages" class="btn btn-success btn-lg btn-block" target="_blank">Test your code on repl.it</a>
          </div>
          <div id="curl" class="tab-pane fade"></br>
            <div class="alert alert-info" role="alert">When using this tool to create a cURL request, please make sure that you do not use the same delimiters for the request and within the JSON body. For example: <br /><code>--data-raw '[{"text": "And the world stood still. But only for a single moment."}]'</code></div>
            <div id="git-btn-curl" align="right">
            <a href="https://github.com/erhopf/REST-templates/blob/master/cURL/restCall.txt" target="_blank" class="btn btn-social btn-sm btn-github">
              <span class="fa fa-github"></span> Improve this template!
            </a></div>
            <pre>curl -X {{ httpMethod | capitalize }} '{{ baseURL }}{{ resource }}<span v-if="params[0].key.length >= 1 && params[0].value.length >= 1">?{{params[0].key}}={{ params[0].value | encodeUrl }}</span><span v-if="params[1].key.length >= 1 && params[1].value.length >= 1">&{{params[1].key}}={{ params[1].value | encodeUrl }}</span><span v-if="params[2].key.length >= 1 && params[2].value.length >= 1">&{{params[2].key}}={{ params[2].value | encodeUrl }}</span><span v-if="params[3].key.length >= 1 && params[3].value.length >= 1">&{{params[3].key}}={{ params[3].value | encodeUrl }}</span>' <span v-if="authHeaders.includes('subscriptionKey')">\<br />-H 'Ocp-Apim-Subscription-Key: YOUR_SUBSCRIPTION_KEY' </span><span v-if="authHeaders.includes('accessToken')">\<br />-H 'Authorization: Bearer YOUR_TOKEN_HERE' </span><span v-if='contentTypeHeader.length > 1'>\<br />-H 'Content-Type: {{contentTypeHeader}}' </span><span v-if="jsonBody.length >= 1">\<br />--data-raw '{{ jsonBody }}'</span> | json_pp</pre>
            <a href="https://repl.it/languages" class="btn btn-success btn-lg btn-block" target="_blank">Test your code on repl.it</a>
          </div>
          <div id="java" class="tab-pane fade"></br>
            <div id="git-btn-curl" align="right">
            <a href="https://github.com/erhopf/REST-templates/blob/master/cURL/resTemplate.java" target="_blank" class="btn btn-social btn-sm btn-github">
              <span class="fa fa-github"></span> Improve this template!
            </a></div>
            <pre>import java.io.*;
import java.net.*;
import java.util.*;
import com.google.gson.*;
import com.squareup.okhttp.*;

public class {{functionName}} {
    String subscriptionKey = "YOUR_SUBSCRIPTION_KEY";
    String url = "{{ baseURL }}{{ resource }}<span v-if="params[0].key.length >= 1 && params[0].value.length >= 1">?{{params[0].key}}={{ params[0].value | encodeUrl }}</span><span v-if="params[1].key.length >= 1 && params[1].value.length >= 1">&{{params[1].key}}={{ params[1].value | encodeUrl }}</span><span v-if="params[2].key.length >= 1 && params[2].value.length >= 1">&{{params[2].key}}={{ params[2].value | encodeUrl }}</span>";

    OkHttpClient client = new OkHttpClient();

    public String {{ httpMethod }}() throws IOException {
        MediaType mediaType = MediaType.parse("application/json");
        RequestBody body = RequestBody.create(mediaType,
                "[{\n\t\"Text\": \"Welcome to Microsoft Translator. Guess how many languages I speak!\"\n}]");
        Request request = new Request.Builder()
                .url(url).{{ httpMethod }}(body)
                // Add additional headers here.
                .addHeader("Ocp-Apim-Subscription-Key", subscriptionKey)
                .addHeader("Content-type", "application/json").build();
        Response response = client.newCall(request).execute();
        return response.body().string();
    }

    public static String prettify(String json_text) {
        JsonParser parser = new JsonParser();
        JsonElement json = parser.parse(json_text);
        Gson gson = new GsonBuilder().setPrettyPrinting().create();
        return gson.toJson(json);
    }

    public static void main(String[] args) {
        try {
            {{functionName}} sampleRequest = new {{functionName}}();
            String response = sampleRequest.post();
            System.out.println(prettify(response));
        } catch (Exception e) {
            System.out.println(e);
        }
    }
}
            </pre>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
    <script type="text/javascript" src="js/script.js"></script>
  </body>
</html>
